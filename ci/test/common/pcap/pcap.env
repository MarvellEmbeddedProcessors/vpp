#!/bin/bash
# SPDX-License-Identifier: Apache-2.0
# Copyright(C) 2025 Marvell.

PCAP_UTILS_PATH=$(dirname $(readlink -f "${BASH_SOURCE[0]}"))

if ! [ -e $PCAP_UTILS_PATH/pcap-pkt-cnt ]; then
	gcc $PCAP_UTILS_PATH/pcap_len.c -lpcap -o $PCAP_UTILS_PATH/pcap-len
	gcc $PCAP_UTILS_PATH/pcap_pkt_cnt.c -lpcap -o $PCAP_UTILS_PATH/pcap-pkt-cnt
	gcc $PCAP_UTILS_PATH/pcap_mac.c -lpcap -o $PCAP_UTILS_PATH/pcap-mac
fi

function pcap_packet_count()
{
	$PCAP_UTILS_PATH/pcap-pkt-cnt $1
}

function pcap_length()
{
	$PCAP_UTILS_PATH/pcap-len $1
}

function pcap_packet_dmac()
{
	$PCAP_UTILS_PATH/pcap-mac $1 "dst"
}

function pcap_packet_smac()
{
	$PCAP_UTILS_PATH/pcap-mac $1 "src"
}
